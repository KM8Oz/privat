{"version":3,"sources":["webpack:///./src/pages/streamer.vue?6813","webpack:///src/pages/streamer.vue","webpack:///./src/pages/streamer.vue?1a2c","webpack:///./src/pages/streamer.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","staticStyle","on","$event","clickButton","_v","call","attrs","staticRenderFns","checklive","modelid","ansver","videoInput","videoOutput","webRtcPeer","NO_CALL","PROCESSING_CALL","IN_CALL","callState","document","getElementById","$options","sockets","onmessage","an","JSON","parse","data","console","log","response","methods","message","processAnswer","sdpAnswer","then","Nmodelid","wsss","$socket","options","localVideo","remoteVideo","onicecandidate","onIceCandidate","kurentoUtils","WebRtcPeer","WebRtcPeerSendrecv","candidate","stringify","id","sendMessage","jsonMessage","send","video","querySelector","navigator","mediaDevices","getUserMedia","error","name","component","QPage","QBtn"],"mappings":"2GAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,SAAS,CAACE,YAAY,8BAA8BC,YAAY,CAAC,SAAW,SAAS,CAACH,EAAG,QAAQ,CAACI,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOT,EAAIU,iBAAiB,CAACV,EAAIW,GAAG,iBAAiBP,EAAG,QAAQ,CAACI,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOT,EAAIY,UAAU,CAACZ,EAAIW,GAAG,WAAWP,EAAG,MAAM,CAACE,YAAY,QAAQC,YAAY,CAAC,aAAa,SAAS,CAACH,EAAG,KAAK,CAACG,YAAY,CAAC,QAAU,WAAWH,EAAG,QAAQ,CAACE,YAAY,QAAQO,MAAM,CAAC,GAAK,aAAa,SAAW,GAAG,YAAc,QAAQ,SAAW,GAAG,OAAS,OAAOT,EAAG,QAAQ,CAACE,YAAY,QAAQO,MAAM,CAAC,GAAK,cAAc,SAAW,GAAG,YAAc,QAAQ,SAAW,GAAG,OAAS,UAAU,IAC3sBC,EAAkB,GCatB,G,8BAAA,CACE,OACE,MAAO,CACLC,WAAW,EACXC,QAAS,UACTC,OAAQ,KACRC,WAAY,KACZC,YAAa,KACbC,WAAY,KACZC,QAAS,EACTC,gBAAiB,EACjBC,QAAS,EACTC,UAAW,OAGf,eACEvB,KAAKiB,WAAaO,SAASC,eAAe,cAC1CzB,KAAKkB,YAAcM,SAASC,eAAe,gBAG7C,UAGEzB,KAAK0B,SAASC,QAAQC,UAAY,SAAtC,GACM,IAAIC,EAAKC,KAAKC,MAAMC,EAAKA,MACzBC,QAAQC,IAAIF,GACO,YAAfH,EAAGM,WACLnC,KAAKgB,OACb,qEAIEoB,QAAS,CACP,mBAAmBC,GACjBrC,KAAKmB,WAAWmB,cAAcD,EAAQE,WACtCvC,KAAK0B,SAASC,QAAQC,UAAYI,KAAKQ,KAAKP,QAAQC,IAAIF,QAG1D,OACE,IAAIS,EAAWzC,KAAKe,QAGpB,IAAI2B,EAAO1C,KAAK2C,QAChB,IAAIC,EAAU,CACZC,WAAY7C,KAAKiB,WACjB6B,YAAa9C,KAAKkB,YAClB6B,eAAgB/C,KAAKgD,gBAGvBhD,KAAKmB,WAAa8B,aAAaC,WAAWC,mBAChD,GACA,YACA,GACU,QAAV,SAGQ,KAAR,6BACA,GACY,QAAZ,SAEU,IAAV,GACY,GAAZ,OACY,KAAZ,EACY,GAAZ,OACY,SAAZ,GAEA,oBACU,QAAV,2BACU,EAAV,eAMI,eAAeC,GACbnB,QAAQC,IAAI,kBAAoBJ,KAAKuB,UAAUD,IAE/C,IAAIf,EAAU,CACZiB,GAAI,iBACJF,UAAWA,GAEbpD,KAAKuD,YAAYlB,IAGnB,YAAYA,GACV,IAAImB,EAAc1B,KAAKuB,UAAUhB,GACjCJ,QAAQC,IAAI,oBAAsBsB,GAClCxD,KAAK2C,QAAQc,KAAKD,IAGpB,cACExD,KAAK2C,QAAQc,KAAK3B,KAAKuB,UAAU,CAAvC,mCACMrD,KAAKgB,OAAS,oCAEhB,gBACEhB,KAAK0D,MAAQlC,SAASmC,cAAc,SAChCC,UAAUC,cAAgBD,UAAUC,aAAaC,cACnDF,UAAUC,aAClB,cAAU,OAAV,EAAU,OAAV,IACA,UAIU,KAAV,kBACU,KAAV,wCACU,KAAV,iBAII,YAAYE,GACV9B,QAAQC,IAAI,sBAAwB6B,EAAMC,KAAMD,OC5HwS,I,yDCO1VE,EAAY,eACd,EACAnE,EACAe,GACA,EACA,KACA,KACA,MAIa,aAAAoD,EAAiB,QAIhC,IAASA,EAAW,aAAc,CAACC,QAAA,KAAMC,OAAA","file":"js/20.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('q-page',{staticClass:\"bg-white text-black q-pa-lg\",staticStyle:{\"overflow\":\"auto\"}},[_c('q-btn',{on:{\"click\":function($event){return _vm.clickButton()}}},[_vm._v(\"регистрация\")]),_c('q-btn',{on:{\"click\":function($event){return _vm.call()}}},[_vm._v(\"старт\")]),_c('div',{staticClass:\"col-6\",staticStyle:{\"margin-top\":\"15px\"}},[_c('h2',{staticStyle:{\"display\":\"block\"}}),_c('video',{staticClass:\"col-3\",attrs:{\"id\":\"videoInput\",\"controls\":\"\",\"playsinline\":\"false\",\"autoplay\":\"\",\"volume\":\"0\"}}),_c('video',{staticClass:\"col-3\",attrs:{\"id\":\"videoOutput\",\"controls\":\"\",\"playsinline\":\"false\",\"autoplay\":\"\",\"volume\":\"0\"}})])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <q-page class=\"bg-white text-black q-pa-lg\" style=\"overflow: auto;\">\r\n    <q-btn @click=\"clickButton()\">регистрация</q-btn>\r\n    <q-btn @click=\"call()\">старт</q-btn>\r\n    <div class=\"col-6\" style=\"margin-top: 15px;\">\r\n      <h2 style=\"display: block;\"></h2>\r\n      <video class=\"col-3\" id=\"videoInput\" controls playsinline=\"false\" autoplay volume=\"0\"></video>\r\n      <video class=\"col-3\" id=\"videoOutput\" controls playsinline=\"false\" autoplay volume=\"0\"></video>\r\n    </div>\r\n  </q-page>\r\n</template>\r\n\r\n<script>\r\nimport { LocalStorage } from 'quasar';\r\nexport default {\r\n  data() {\r\n    return {\r\n      checklive: true,\r\n      modelid: \"mariuka\",\r\n      ansver: null,\r\n      videoInput: null,\r\n      videoOutput: null,\r\n      webRtcPeer: null,\r\n      NO_CALL: 0,\r\n      PROCESSING_CALL: 1,\r\n      IN_CALL: 2,\r\n      callState: null\r\n    };\r\n  },\r\n  beforeCreate() {\r\n    this.videoInput = document.getElementById(\"videoInput\");\r\n    this.videoOutput = document.getElementById(\"videoOutput\");\r\n  },\r\n\r\n  mounted() {\r\n    //this.$socket.send(JSON.stringify({ id: \"register\", name: this.modelid }));\r\n    //this.ansver = \"дождитесь регистрации в сети PCM\";\r\n    this.$options.sockets.onmessage = function(data) {\r\n      let an = JSON.parse(data.data);\r\n      console.log(data);\r\n      if (an.response == \"accepted\") {\r\n        this.ansver =\r\n          \"вы успешно зарегистрированы в сети, можете запустить трансляцию\";\r\n      }\r\n    };\r\n  },\r\n  methods: {\r\n    startCommunication(message) {\r\n      this.webRtcPeer.processAnswer(message.sdpAnswer);\r\n      this.$options.sockets.onmessage = data.then(console.log(data));\r\n    },\r\n\r\n    call() {\r\n      var Nmodelid = this.modelid;\r\n      var webRtcPeer;\r\n      var pipeline;\r\n      let wsss = this.$socket;\r\n      var options = {\r\n        localVideo: this.videoInput,\r\n        remoteVideo: this.videoOutput,\r\n        onicecandidate: this.onIceCandidate\r\n      };\r\n\r\n      this.webRtcPeer = kurentoUtils.WebRtcPeer.WebRtcPeerSendrecv(\r\n        options,\r\n        function(error) {\r\n          if (error) {\r\n            console.error(error);\r\n          }\r\n\r\n          this.generateOffer(function(error, offerSdp) {\r\n            if (error) {\r\n              console.error(error);\r\n            }\r\n            var message = {\r\n              id: \"call\",\r\n              from: Nmodelid,\r\n              to: \"niko\",\r\n              sdpOffer: offerSdp\r\n            };\r\n            var jsonMessage = JSON.stringify(message);\r\n            console.log(\"Sending message: \" + jsonMessage);\r\n            wsss.send(jsonMessage);\r\n          });\r\n        }\r\n      );\r\n    },\r\n\r\n    onIceCandidate(candidate) {\r\n      console.log(\"Local candidate\" + JSON.stringify(candidate));\r\n\r\n      var message = {\r\n        id: \"onIceCandidate\",\r\n        candidate: candidate\r\n      };\r\n      this.sendMessage(message);\r\n    },\r\n\r\n    sendMessage(message) {\r\n      var jsonMessage = JSON.stringify(message);\r\n      console.log(\"Sending message: \" + jsonMessage);\r\n      this.$socket.send(jsonMessage);\r\n    },\r\n\r\n    clickButton() {\r\n      this.$socket.send(JSON.stringify({ id: \"register\", name: this.modelid }));\r\n      this.ansver = \"дождитесь регистрации в сети PCM\";\r\n    },\r\n    handleSuccess() {\r\n      this.video = document.querySelector(\"video\");\r\n      if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\r\n        navigator.mediaDevices\r\n          .getUserMedia({ video: true, audio: true })\r\n          .then(stream => {\r\n            //console.log(stream);\r\n            //let videoTracks = stream.getVideoTracks();\r\n            // console.log(videoTracks);\r\n            this.video.srcObject = stream;\r\n            this.video.src = window.URL.createObjectURL(stream);\r\n            this.video.play();\r\n          });\r\n      }\r\n    },\r\n    handleError(error) {\r\n      console.log(\"getUserMedia error:\" + error.name, error);\r\n    }\r\n  }\r\n};\r\n</script>\r\n","import mod from \"-!../../node_modules/@quasar/app/lib/webpack/loader.transform-quasar-imports.js!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/@quasar/app/lib/webpack/loader.auto-import-client.js?kebab!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./streamer.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/@quasar/app/lib/webpack/loader.transform-quasar-imports.js!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/@quasar/app/lib/webpack/loader.auto-import-client.js?kebab!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./streamer.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./streamer.vue?vue&type=template&id=ba24995a&\"\nimport script from \"./streamer.vue?vue&type=script&lang=js&\"\nexport * from \"./streamer.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\nimport QPage from 'quasar/src/components/page/QPage.js';\nimport QBtn from 'quasar/src/components/btn/QBtn.js';\nimport qInstall from \"../../node_modules/@quasar/app/lib/webpack/runtime.auto-import.js\";\nqInstall(component, 'components', {QPage,QBtn});\n"],"sourceRoot":""}