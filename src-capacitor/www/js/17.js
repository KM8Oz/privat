(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[17],{"0813":function(e,t,o){},4169:function(e,t,o){"use strict";o("0813")},dbe1:function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[e.showPopup?o("div",{staticClass:"popup"},[o("div",{staticClass:"close",on:{click:function(t){e.showPopup=!1}}},[e._v(" X")]),e._l(e.song,(function(t,a){return o("div",{key:a,staticClass:"song",on:{click:function(o){return e.selectAudio(t)}}},[e._v(" "+e._s(t.name))])})),o("div",{staticClass:"song",on:{click:function(t){return e.selectAudioFromPc()}}},[e._v("Select form folder")])],2):e._e(),o("audio",{staticStyle:{display:"none"},attrs:{crossOrigin:"anonymous",controls:""}}),o("video",{attrs:{autoplay:"",playsinline:"",width:e.width,height:e.height}}),e.showRecord?o("button",{staticClass:"addmusic",on:{click:e.showMusic}},[e._v("Add Music")]):e._e(),e.showRecord?o("button",{staticClass:"record",on:{click:e.startRecord}},[e._v("Record")]):e._e(),e.showStop?o("button",{staticClass:"record",on:{click:e.stopRecord}},[e._v("Stop")]):e._e(),e.showPlay?o("button",{staticClass:"record",on:{click:e.playRecord}},[e._v("Play")]):e._e(),e.showNext?o("button",{staticClass:"next",on:{click:function(t){return e.post()}}},[e._v("Post")]):e._e(),e.showBack?o("button",{staticClass:"back",on:{click:function(t){return e.backRecord()}}},[e._v("Back")]):e._e(),e.isLoading?o("loader91"):e._e()],1)},i=[],r=(o("ddb0"),o("2b3d"),o("c973")),n=o.n(r),s={data(){return{song:[{url:"https://money91kxtvk2qmhk.cdn.e2enetworks.net/c04bbf42-cad5-4606-bd62-0fea1e8abcf3.mpga",name:"Lehanga Jass Manak (Official Song)"},{url:"https://money91kxtvk2qmhk.cdn.e2enetworks.net/cbf41607-f5b9-46b3-857d-4e7c50347ecf.mpga",name:"Badshah - DJ Waley Babu "},{url:"https://money91kxtvk2qmhk.cdn.e2enetworks.net/7014c6ab-4f8f-4b6a-9f97-a56b9c1df9d3.mpga",name:"Genda Phool song from delhi 6"},{url:"https://money91kxtvk2qmhk.cdn.e2enetworks.net/c2b37ba6-aa9e-4af3-abb6-044d60bae375.mpga",name:"लॉलीपॉप लागेलू - Pawan Singh"}],showPopup:!1,showStop:!1,showRecord:!0,showPlay:!1,showBack:!1,selectedAudio:null,width:window.innerWidth,height:window.innerHeight,player:null,video:null,audioPlayer:null,dataAvailable:!1,showNext:!1,isLoading:!1,recorder:null,recordedData:null,videoStream:null,audioStream:null}},computed:{music:{get(){return this.$store.state.music},set(e){return this.$store.dispatch("setMusic",e)}},user:{get(){return this.$store.state.user},set(e){return this.$store.dispatch("setUser",e)}}},mounted(){var e=this;return n()((function*(){yield e.initiateCamera()}))()},methods:{initiateCamera(){var e=this;return n()((function*(){var t=e;t.isLoading=!0,t.video=document.querySelector("video"),yield e.captureCamera(function(){var e=n()((function*(e){t.video.muted=!0,t.video.volume=0,t.video.srcObject=e,t.videoStream=e,t.isLoading=!1}));return function(t){return e.apply(this,arguments)}}())}))()},captureCamera(e){navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0},video:{width:this.width,height:this.height}}).then((function(t){e(t)})).catch((function(e){console.error("Unable to capture your camera. Please check console logs."),console.error(e)}))},getMp3Stream(e){var t=new FileSelector;t.accept="*.mp3",t.selectSingleFile((function(t){try{window.AudioContext=window.AudioContext||window.webkitAudioContext;var o=new AudioContext,a=o.createGain();a.connect(o.destination),a.gain.value=0;var i=new FileReader;function r(t){var i=o.createBufferSource();i.buffer=t,i.start(0,0),i.connect(a);var r=o.createMediaStreamDestination();i.connect(r),e(r.stream,1e3*t.duration)}i.onload=function(e){o.decodeAudioData(e.target.result,r,(e=>{console.log("File type not valid",e)}))},i.readAsArrayBuffer(t)}catch(n){console.log("error",n)}}),(function(){console.log("Please select mp3 file.")}))},selectAudioFromPc(){var e=this;return n()((function*(){var t=e;yield e.getMp3Stream(function(){var e=n()((function*(e){navigator.mediaDevices.getUserMedia({video:{width:t.width,height:t.height}}).then(function(){var o=n()((function*(o){t.video.muted=!0,t.video.volume=0,t.video.srcObject=o,t.videoStream=o,t.audioStream=e,t.audioPlayer=yield document.querySelector("audio"),t.audioPlayer.volume=1,t.audioPlayer.srcObject=e,t.selectedAudio=e,t.showPopup=!1,console.log("camera",o),console.log("mp3Stream",e)}));return function(e){return o.apply(this,arguments)}}())}));return function(t){return e.apply(this,arguments)}}())}))()},selectAudio(e){var t=this;return n()((function*(){var o=t;o.isLoading=!0,null==t.selectedAudio&&navigator.mediaDevices.getUserMedia({video:{width:o.width,height:o.height}}).then(function(){var t=n()((function*(t){o.video.muted=!0,o.video.volume=0,o.video.srcObject=t,o.videoStream=t,o.audioPlayer=yield document.querySelector("audio"),o.audioPlayer.volume=1,o.audioPlayer.src=e.url,yield o.audioPlayer.load(),o.audioPlayer.addEventListener("canplay",n()((function*(){console.log("canplay");try{let e;const t=0;o.audioPlayer.captureStream?e=yield o.audioPlayer.captureStream(t):o.audioPlayer.mozCaptureStream?e=yield o.audioPlayer.mozCaptureStream(t):(console.error("Stream capture is not supported"),e=null),o.audioStream=e,o.selectedAudio=o.audioStream,o.isLoading=!1}catch(e){console.log("error",e)}}))),o.showPopup=!1,o.isLoading=!1}));return function(e){return t.apply(this,arguments)}}())}))()},showMusic(){this.showPopup=!0,this.audioStream=null,console.log("showMusic")},backRecord(){this.$router.go("-1")},startRecord(){var e=this;return n()((function*(){if(console.log("this.audioPlayer",e.audioPlayer),null==e.audioPlayer)e.recorder=yield RecordRTC(e.videoStream,{type:"video"}),console.log("this.videoStream",e.videoStream);else{var t=new MediaStream;null!==e.audioStream&&(yield getTracks(e.audioStream,"audio").forEach(function(){var e=n()((function*(e){yield t.addTrack(e)}));return function(t){return e.apply(this,arguments)}}())),null!==e.videoStream&&(yield getTracks(e.videoStream,"video").forEach(function(){var e=n()((function*(e){yield t.addTrack(e)}));return function(t){return e.apply(this,arguments)}}())),e.recorder=yield RecordRTC(t,{type:"video"})}e.recorder.camera=e.videoStream,e.showStop=!0,e.showRecord=!1,e.showPlay=!1,null!==e.audioPlayer&&e.audioPlayer.play(),e.recorder.startRecording(),setTimeout((function(e){e.stopRecord()}),1e4,e)}))()},stopRecordingCallback(){console.log("here",URL.createObjectURL(this.recorder.getBlob())),this.recordedData=this.recorder.getBlob(),this.video.src=this.video.srcObject=null,this.video.muted=!1,this.video.volume=1,this.video.autoplay=!1,this.video.src=URL.createObjectURL(this.recorder.getBlob()),this.dataAvailable=!0,this.recordedData=this.recorder.getBlob(),null!==this.audioPlayer&&(this.audioPlayer.pause(),this.audioPlayer.src=this.audioPlayer.srcObject=null),this.selectedAudio=null,this.recorder.camera.stop(),this.recorder.destroy(),this.recorder=null},stopRecord(){this.showStop=!1,this.showRecord=!1,this.showPlay=!0,null!==this.recorder&&this.recorder.stopRecording(this.stopRecordingCallback)},playRecord(){this.showStop=!1,this.showRecord=!1,this.showPlay=!0,this.video.play(),this.dataAvailable&&(this.showNext=!0,this.showBack=!0)},post(){var e=this;return n()((function*(){e.isLoading=!0;var t=yield e.axios.put("https://test4.services-money91.com/upload_file/binary?fileType=webm",e.recordedData,{headers:{"Content-Type":"application/octet-stream","X-Auth-Id":e.xauthid,"JWT-TOKEN":e.jwtToken}});if(t.data.Success){let o=yield e.axios.post(`${window.serverUrl}api/uploadvideo`,{userId:e.user.id,xauthtoken:e.xauthtoken,name:null,poster:null,url:t.data.Data.CdnUrl});null!==o&&o.data.status?e.isLoading=!1:e.$toast.bottom(o.data.message),e.$router.go("-1")}else e.isLoading=!1,console.log("not uploaded!")}))()}},beforeDestroy(){this.player}},c=s,d=(o("4169"),o("2877")),l=Object(d["a"])(c,a,i,!1,null,"d21107a4",null);t["default"]=l.exports}}]);
//# sourceMappingURL=17.js.map