(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[17],{"4a6c":function(e,t,o){"use strict";o.r(t);var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("q-page",{staticClass:"bg-white text-black q-pa-lg",staticStyle:{overflow:"auto"}},[o("q-btn",{on:{click:function(t){return e.clickButton()}}},[e._v("регистрация")]),o("q-btn",{on:{click:function(t){return e.call()}}},[e._v("старт")]),o("div",{staticClass:"col-6",staticStyle:{"margin-top":"15px"}},[o("h2",{staticStyle:{display:"block"}}),o("video",{staticClass:"col-3",attrs:{id:"videoInput",controls:"",playsinline:"false",autoplay:"",volume:"0"}}),o("video",{staticClass:"col-3",attrs:{id:"videoOutput",controls:"",playsinline:"false",autoplay:"",volume:"0"}})])],1)},s=[],n=(o("ddb0"),o("2b3d"),o("18d6"),{data(){return{checklive:!0,modelid:"mariuka",ansver:null,videoInput:null,videoOutput:null,webRtcPeer:null,NO_CALL:0,PROCESSING_CALL:1,IN_CALL:2,callState:null}},beforeCreate(){this.videoInput=document.getElementById("videoInput"),this.videoOutput=document.getElementById("videoOutput")},mounted(){this.$options.sockets.onmessage=function(e){let t=JSON.parse(e.data);console.log(e),"accepted"==t.response&&(this.ansver="вы успешно зарегистрированы в сети, можете запустить трансляцию")}},methods:{startCommunication(e){this.webRtcPeer.processAnswer(e.sdpAnswer),this.$options.sockets.onmessage=data.then(console.log(data))},call(){var e=this.modelid;let t=this.$socket;var o={localVideo:this.videoInput,remoteVideo:this.videoOutput,onicecandidate:this.onIceCandidate};this.webRtcPeer=kurentoUtils.WebRtcPeer.WebRtcPeerSendrecv(o,(function(o){o&&console.error(o),this.generateOffer((function(o,i){o&&console.error(o);var s={id:"call",from:e,to:"niko",sdpOffer:i},n=JSON.stringify(s);console.log("Sending message: "+n),t.send(n)}))}))},onIceCandidate(e){console.log("Local candidate"+JSON.stringify(e));var t={id:"onIceCandidate",candidate:e};this.sendMessage(t)},sendMessage(e){var t=JSON.stringify(e);console.log("Sending message: "+t),this.$socket.send(t)},clickButton(){this.$socket.send(JSON.stringify({id:"register",name:this.modelid})),this.ansver="дождитесь регистрации в сети PCM"},handleSuccess(){this.video=document.querySelector("video"),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((e=>{this.video.srcObject=e,this.video.src=window.URL.createObjectURL(e),this.video.play()}))},handleError(e){console.log("getUserMedia error:"+e.name,e)}}}),a=n,c=o("2877"),l=o("9989"),d=o("9c40"),r=o("eebe"),u=o.n(r),v=Object(c["a"])(a,i,s,!1,null,null,null);t["default"]=v.exports;u()(v,"components",{QPage:l["a"],QBtn:d["a"]})}}]);
//# sourceMappingURL=17.js.map